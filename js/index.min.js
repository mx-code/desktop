$(function(){function e(){$(document).keyup(function(e){27==e.keyCode&&$("div.showDiv").remove()}),$("div.showDiv").mousedown(function(e){3==e.which&&e.stopPropagation()})}function i(e){e.preventDefault();var i=e.pageX,n=e.pageY,t=$("div.contextmenu"),o=t.width(),c=t.height(),s=$(window);i>s.width()-o?t.css({left:i-o+"px",top:n+10+"px"}).show():n>s.height()-c?t.css({left:i+10+"px",top:n-c+"px"}).show():$("div.contextmenu").css({left:i+10+"px",top:n+10+"px"}).show()}setInterval(function(){var e=new Date,i=e.getFullYear(),n=e.getMonth()+1,t=e.getDate(),o=e.getDay(),c=e.getHours(),s=e.getMinutes(),u=e.getSeconds(),p="";c=10>c?"0"+c:c,s=10>s?"0"+s:s,u=10>u?"0"+u:u;var a=new Array(7);a[0]="星期日",a[1]="星期一",a[2]="星期二",a[3]="星期三",a[4]="星期四",a[5]="星期五",a[6]="星期六",o=a[o],p+=i+"年"+n+"月"+t+"日 ",p+=c+":"+s+":"+u,p+=" "+o,$("time").html(p)},500),$(document).mousedown(function(e){3==e.which&&(i(e),$("ul.clickMenu").hide(),$("a.new").removeClass("clickbg"))}),$(document).click(function(e){1==e.which&&($("div.contextmenu").hide(),$("ul.clickMenu").hide(),$("a.new").removeClass("clickbg"))}),$(document).keyup(function(e){27!=e.keyCode&&13!=e.keyCode||($("div.contextmenu").hide(),$("ul.clickMenu").hide(),$("a.new").removeClass("clickbg"))}),$(document).contextmenu(function(e){e.preventDefault()}),$("div.desktop").delegate("a.new","click",function(e){e.preventDefault(),e.stopPropagation(),$(this).addClass("clickbg").siblings().removeClass("clickbg"),$("div.contextmenu").hide()}),$("div.desktop").delegate("a.new","dblclick",function(){var e=this.href;window.open(e),$(this).addClass("clickbg").siblings().removeClass("clickbg")}),$("div.desktop").delegate("a.new","mousedown",function(e){3==e.which&&(e.stopPropagation(),$("div.contextmenu").hide(),$(this).addClass("clickbg").siblings().removeClass("clickbg"),$(this).after($("ul.clickMenu").show()),$("ul.clickMenu").css({left:e.pageX,top:e.pageY}))}),$("div.new").click(function(){var i,n=[];n.push('<div class="showDiv">'),n.push('<div class="sdv">'),n.push('名称:<br /> <input class="newName" /><br />'),n.push('url: <input class="newUrl" /><br />'),n.push('<button class="newBtn">确认</button>'),n.push("</div></div>"),i=n.join(""),$("script").eq(0).before(i),$("input.newName").focus(),$("button.newBtn").click(function(){var e=$(this).siblings("input.newUrl"),i=$(this).siblings("input.newName");if(e.val().trim().length<1)return e.focus(),!1;if(e=e.val(),i.val().trim().length<1)return i.focus(),!1;i=i.val();var n,t=[];t.push('<a class="new" target="_blank" href="'+e+'">'),t.push('<figure><img src="img/ie.jpg">'),t.push("<figcaption>"+i+"</figcaption>"),t.push("</figure></a>"),n=t.join(""),$("div.desktop").append(n),$("div.showDiv").remove()}),$("div.showDiv").on("keyup","input",function(e){13==e.keyCode&&$("button.newBtn").trigger("click")}),e()}),$("ul.clickMenu li.open").click(function(e){var i=this.parentNode.previousSibling.href;return window.open(i),$("ul.clickMenu").hide(),$("a.new").removeClass("clickbg"),!1}),$("ul.clickMenu li.property").click(function(e){var i=$("div.proBox"),n=i.width(),t=i.height(),o=e.pageX,c=e.pageY;o>$(window).width()-n?i.css({left:e.pageX-n+"px"}):c>$(window).height()-t?i.css({top:e.pageY-t+"px"}):$("div.proBox").css({left:e.pageX,top:e.pageY}),$("div.proBox").show();var s=$(this).parent().prev().find("figcaption").text(),u=this.parentNode.previousSibling.href;$("input.proName").val(s),$("input.proUrl").val(u),$(this).parent().before($("div.proBox"))}),$("div.proBox").mousedown(function(e){3==e.which&&(e.stopPropagation(),$("div.contextmenu").hide())}),$("button.okBtn").click(function(){var e=$(this).parent().siblings("label"),i=$(this).parents("div.proBox").prev("a.new"),n=e.find("input.proName").val().trim().length;return len2=e.find("input.proUrl").val().trim().length,n>0&&len2>0?(proName=e.find("input.proName").val(),proUrl=e.find("input.proUrl").val(),i.find("figcaption").text(proName),i[0].href=proUrl,void $("div.proBox").hide()):!1}),$("div.proBox").on("keyup","input",function(e){13==e.keyCode&&$("button.okBtn").trigger("click")}),$("button.cancelBtn").click(function(){$("div.proBox").hide()}),$(document).keyup(function(e){27==e.which&&$("div.proBox").hide()}),$("div.changePic").click(function(){var i,n=[];n.push('<div class="showDiv">'),n.push('<div class="sdv">'),n.push("<p>需将图片放置指定路径下</p>"),n.push('<input type="radio" name="bg1"  checked="checked" />拉伸'),n.push('<input type="radio" name="bg1" />不拉伸<br />'),n.push('<input type="radio" name="bg2" />平铺'),n.push('<input type="radio" name="bg2" checked="checked" />不平铺 <br />'),n.push('<input type="text" class="showInput" placeholder=" 例如：**.jpg /**.png " />'),n.push('<button class="btn">确认</button>'),n.push("</div></div>"),i=n.join(""),$("script").eq(0).before(i),$("input.showInput").focus(),$("input.showInput").keyup(function(e){13==e.keyCode&&$("button.btn").trigger("click")}),$("button.btn").click(function(){var e=$("input.showInput").val();return e.trim().length>0?($("body").css({backgroundImage:"url(img/"+e+")"}),$("input[name=bg1]")[0].checked&&$("body").css({backgroundSize:"100%"}),$("input[name=bg1]")[1].checked&&$("body").css({backgroundSize:"auto"}),$("input[name=bg2]")[0].checked&&$("body").css({backgroundRepeat:"repeat"}),$("input[name=bg2]")[1].checked&&$("body").css({backgroundRepeat:"no-repeat"}),void $("div.showDiv").remove()):!1}),e()}),$("div.refresh").click(function(){location.reload()})});